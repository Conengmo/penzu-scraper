<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File Viewer</title>
    <style>
        /* General Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            display: flex;
            height: 100vh;
        }

        #file-list {
            width: 20%;
            border-right: 1px solid #ccc;
            padding: 20px;
            height: 100vh;
            overflow-y: auto;
            background-color: #2c3e50;
        }

        #file-list ul {
            list-style-type: none;
            padding: 0;
        }

        #file-list li {
            padding: 10px 15px;
            color: #ecf0f1;
            border-radius: 4px;
            margin-bottom: 10px;
            cursor: pointer;
            background-color: #34495e;
            transition: background-color 0.3s;
        }

        #file-list li:hover {
            background-color: #1abc9c;
        }
        #file-list li.active {
            background-color: #007bff; /* Active button color */
            color: white; /* Active text color */
            border: 1px solid #0056b3; /* Active border */
        }
        #file-list li div {
            pointer-events: none;
        }

        #file-list li .button-title {
            font-size: 16px;
        }
        #file-list li .button-date {
            font-size: 14px;
            color: #bdc3c7;
        }

        #file-content {
            width: 80%;
            padding: 40px;
            overflow-y: auto;
        }

        #file-content h1 {
            font-size: 28px;
            margin-bottom: 20px;
            color: #34495e;
        }

        #content p {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        #content {
            background-color: #ffffff;
            padding: 50px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        hr {
            margin: 20px 0
        }

    </style>
</head>
<body>
<div id="file-list">
    <ul>
        <!-- List of filenames will be dynamically inserted here -->
    </ul>
</div>
<div id="file-content">
    <div id="content"></div>
</div>

<script>
    const fileListEl = document.querySelector("#file-list ul");
    const contentEl = document.getElementById("content");

    // Function to load files incrementally
    async function loadFiles() {
        let i = 0; // Start from filename 0
        let hasMoreFiles = true; // Flag to track if more files are available

        while (hasMoreFiles) {
            const file = `htmls_pretty/${i}.html`;

            try {
                const response = await fetch(file);
                if (!response.ok) { // Check if the response is valid
                    hasMoreFiles = false; // Stop if file is not found
                    break;
                }

                const data = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(data, 'text/html');

                // Assuming title is inside <title> or <h1>, and date in <p class="date">
                const title = doc.querySelector('h1')?.textContent.trim() || 'Untitled';
                const rawDate = doc.querySelector('p.date')?.textContent.trim() || null;

                // Parse and format date using the user's locale
                let formattedDate = 'Unknown date';
                if (rawDate) {
                    const dateObj = new Date(rawDate);
                    if (!isNaN(dateObj)) {
                        formattedDate = dateObj.toLocaleDateString(
                            undefined,
                            { year: 'numeric', month: 'long', day: 'numeric' }
                        );
                    }
                }

                // Create list item
                const li = document.createElement("li");
                li.innerHTML = `
                    <div class="button-title">${title}</div>
                    <div class="button-date">${formattedDate}</div>
                `;
                li.addEventListener("click", function(e) {
                    loadFileContent(file);
                    setActiveButton(e.target);
                });
                fileListEl.appendChild(li);

                i++;

            } catch (error) {
                break;
            }
        }
    }

    function loadFileContent(filename) {
        fetch(filename)
            .then(response => response.text())
            .then(data => {
                contentEl.innerHTML = data;
            })
            .catch(error => {
                contentEl.innerHTML = "Error loading file.";
            });
    }

    // Function to change appearance of the active button
    function setActiveButton(activeButton) {
        // Get all buttons and remove active class
        const buttons = document.querySelectorAll('#file-list > ul > li');
        buttons.forEach(button => {
            button.classList.remove('active'); // Remove active class
        });
        // Add active class to the clicked button
        activeButton.classList.add('active');
    }

    loadFiles();


</script>
</body>
</html>
